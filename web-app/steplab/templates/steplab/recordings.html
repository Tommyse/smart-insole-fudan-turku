{% extends 'steplab/base.html' %}
{% block content%}
<div class="row">
    <div class="col-md-10 offset-1 lm-auto">
        <a data-toggle="collapse" data-target="#uploader" class="btn btn-primary btn-lg float-right" href="#" role="button">Add a new Step File</a>
    </div>
</div>

<div class="row mt-3 collapse" id="uploader">
    <div class="col-md-10 offset-1">
        <form method="post" enctype="multipart/form-data" onsubmit="submitForm()">
            {% csrf_token %}
            <div class="form-group files">
                <label>Upload Your File </label>
                <input type="file" class="form-control" name="new-stepfiles" multiple>
            </div>
            <button type="submit">Submit</button>
        </form>
    </div>
</div>
<div class="row mt-3">
    <div class="col-md-10 offset-1 overflow-auto">
        <table class="table table-hover text-center" id="recordings-table">
            <thead>
                <tr>
                    <th class="table-success">
                        <h4>Filename</h4>
                    </th>
                    <th class="table-success">
                        <h4>Author</h4>
                    </th>
                    <th class="table-success">
                        <h4>Footsize</h4>
                    </th>
                    <th class="table-success">
                        <h4>ProductId</h4>
                    </th>
                    <th class="table-success">
                        <h4>Steps</h4>
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for stepFile in stepFiles %}
                <tr class="">
                    <td>{{ stepFile.title }} </td>
                    <td>{{ stepFile.author }} </td>
                    <td>{{ stepFile.footsize }} </td>
                    <td>{{ stepFile.productId }} </td>
                    <td>{{ stepFile.steps }} </td>
                </tr>
                {% endfor %}
            </tbody>
            {% if not stepFiles %}
            <tfoot>
                <tr>
                  <td colspan="5">There are not any step file!</td>
                </tr>
            </tfoot>
            {% endif %}
        </table>

    </div>
</div>
{% endblock content %}


{% block scripts %}
<script>
     function submitForm() {
        // Get the first form with the name
        var frm = document.getElementsByName('form-name')[0];
        frm.submit(); // Submit
        frm.reset();  // Reset
        return false; // Prevent page refresh
    }

    $(document).ready(function() {
        $('#recordings-table td').click(function() {
            let fileName = this.innerText;
            $.get( "", {filename: fileName}, function( data ) {
                $( "#main-content" ).html( data );
                window.scrollTo(0, 0);
            });
        });
    });
</script>
{% endblock scripts %}